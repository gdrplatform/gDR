<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gDR">
<title>gDR suite • gDR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="gDR suite">
<meta property="og:description" content="gDR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gDR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/gDR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gdrplatform/gDR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>gDR suite</h1>
                        <h4 data-toc-skip class="author">gDR team</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gdrplatform/gDR/blob/HEAD/../../vignettes/gDR.Rmd" class="external-link"><code>../../vignettes/gDR.Rmd</code></a></small>
      <div class="d-none name"><code>gDR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="intro">Introduction<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>Over decades, many departments across gRED and Roche have generated
large amounts of drug response screening data using Genentech’s rich
drug compounds inventory. While extensive labor and time has been
invested to generate these data, they are not analyzed in a standardized
manner for meaningful comparison. On one hand, large screens are
performed across many cell lines and drugs in a semi-automated manner.
On the other hand, small-scale studies, which focused on factors that
contribute to sensitivity and resistance to certain therapies, are
generally performed by each individual scientist with limited
automation. These are complementary approaches but were rarely handled
the same way. Commercial softwares are available for analyzing large
datasets, whereas researchers for small-scale datasets often process
data ad hoc through software like PRISM.</p>
<p>Here, we propose a suite of computational tools that enable the
processing, archiving, and visualization of drug response data from any
experiment, regardless of size or experimental design, thus ensuring
reproducibility and implementation of the Findable, Accessible,
Interoperable, and Reusable (F.A.I.R.) principles, with the goal of
making this accessible to the public community.</p>
<p>For now we share a subset of the gDR suite components for
pre-processing and processing the data.</p>
<div class="section level3">
<h3 id="rpackages">R Packages<a class="anchor" aria-label="anchor" href="#rpackages"></a>
</h3>
<p>gDR suite consists of a few packages that power our app and make it a
comprehensive tool. All the packages under the gDR umbrella are stored
in the <a href="https://github.roche.com/gdrplatform/" class="external-link">gDR platform
GitHub organization</a>.</p>
<p>We are happy to share with you our packages for importing, processing
and managing gDR data: - gDRimport - gDRcore - gDRutils -
gDRtestData</p>
</div>
<div class="section level3">
<h3 id="data-structures">Data structures<a class="anchor" aria-label="anchor" href="#data-structures"></a>
</h3>
<p>The gDR data model is based on the SummarizedExperiment and
BumpyMatrix. If readers are unfamiliar with these data models, we
recommend first reading <a href="https://bioconductor.org/packages/release/bioc/vignettes/SummarizedExperiment/inst/doc/SummarizedExperiment.html" class="external-link">SummarizedExperiment
vignettes</a>, followed by the <a href="https://www.bioconductor.org/packages/devel/bioc/vignettes/BumpyMatrix/inst/doc/BumpyMatrix.html" class="external-link">BumpyMatrix
vignettes</a>. The SummarizedExperiment data structure enables ease of
subsetting within the SummarizedExperiment object, but also provides
ease when trying to correlate drug response data with genomic data, as
these data may jointly stored in a MultiAssayExperiment. The BumpyMatrix
allows for storage of multi-dimensional data while retaining a matrix
abstraction.</p>
<p>This data structure is the core data structure that all downstream
processing functions as well as visualization tools operate off of.</p>
</div>
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>The gDR suite was designed in a modular manner, such that a user can
jump into the “standard” end-to-end gDR processing pipeline at several
entry points as is suitable for his or her needs. The full pipeline
involves:</p>
<pre><code>      manifest, template(s), raw data
                        |
                        |  1. Aggregating all raw data and metadata
                        |  into a single long table. 
                        |
                        V
              single, long table
                        |
                        |  2. Transforming the long table into 
                        |  a SummarizedExperiment object with BumpyMatrix assays 
                        |  by specifying what columns belong on rows, 
                        |  columns, and nested.
                        |
                        V
          SummarizedExperiment object
          with raw and treated assays
                        |
                        |  3. Normalizing, averaging, and fitting data.
                        |
                        V
          SummarizedExperiment object
          with raw, treated, normalized,
           averaged, and metric assays, 
   ready for use by downstream visualization
              </code></pre>
<p>A user should be able to enter any part of this pipeline as long as
they are able to create the intermediate object (i.e., the individual
manifest, template, and raw data files, or a single, long table, or a
SummarizedExperiment object with Bumpy assays).</p>
</div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="section level3">
<h3 id="aggregating-raw-data-and-metadata-1">Aggregating raw data and metadata (1)<a class="anchor" aria-label="anchor" href="#aggregating-raw-data-and-metadata-1"></a>
</h3>
<p>The gDR suite ultimately requires a single, long merged table
containing both raw data and metadata.</p>
<p>To support a common use case, we provide a convenience function that
takes three objects: manifest, template(s), and raw data to create this
single, long merged table for the user. The manifest contains metadata
on the experimental design, template files specify the drugs and cell
lines used, and the raw data output files obtained from a plate reader
or a scanner.</p>
<p>Exemplary data can be found here:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gdrplatform/gDR" class="external-link">gDR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: gDRcore</span></span>
<span><span class="co">#&gt; Loading required package: gDRimport</span></span>
<span><span class="co">#&gt; Loading required package: gDRutils</span></span>
<span><span class="co"># get test data from gDRimport package</span></span>
<span><span class="co"># i.e. paths to manifest, templates and results files</span></span>
<span><span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gdrplatform.github.io/gDRimport/reference/get_test_data.html">get_test_data</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://gdrplatform.github.io/gDRimport/reference/manifest_path-method.html">manifest_path</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span></span></code></pre></div>
<p>[1]
“/usr/local/lib/R/site-library/gDRimport/extdata/data1/manifest.xlsx”</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://gdrplatform.github.io/gDRimport/reference/template_path-method.html">template_path</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span></span></code></pre></div>
<p>[1]
“/usr/local/lib/R/site-library/gDRimport/extdata/data1/Template_7daytreated.xlsx”
[2]
“/usr/local/lib/R/site-library/gDRimport/extdata/data1/Template_Untreated.xlsx”</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://gdrplatform.github.io/gDRimport/reference/result_path-method.html">result_path</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span></span></code></pre></div>
<p>[1]
“/usr/local/lib/R/site-library/gDRimport/extdata/data1/RawData_day0.xlsx”
[2]
“/usr/local/lib/R/site-library/gDRimport/extdata/data1/RawData_day7.xlsx”</p>
<p>Using the convenience function <code>import_data</code>, the long
table is easily created:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import data</span></span>
<span><span class="va">imported_data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/import_data.html">import_data</a></span><span class="op">(</span><span class="fu"><a href="https://gdrplatform.github.io/gDRimport/reference/manifest_path-method.html">manifest_path</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span>, <span class="fu"><a href="https://gdrplatform.github.io/gDRimport/reference/template_path-method.html">template_path</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span>, <span class="fu"><a href="https://gdrplatform.github.io/gDRimport/reference/result_path-method.html">result_path</a></span><span class="op">(</span><span class="va">td</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">imported_data</span><span class="op">)</span></span></code></pre></div>
<p>This function will expect certain “identifiers” that tell the
processing functions which columns in the long table map to certain
expected fields, so that each column is interpreted correctly. For more
details regarding these identifiers, see the “Details” section of
<code><a href="https://gdrplatform.github.io/gDRstyle/reference/identifiers.html">?identifiers</a></code>. Use <code>set_env_identifier</code> or
<code>set_SE_identifiers</code> to set up the correct mappings between
the expected fields and your long table column names.</p>
</div>
<div class="section level3">
<h3 id="transforming-data-into-a-summarizedexperiment-2">Transforming data into a SummarizedExperiment (2)<a class="anchor" aria-label="anchor" href="#transforming-data-into-a-summarizedexperiment-2"></a>
</h3>
<p>Next, we can transform the long table into our initial
SummarizedExperiment object. To do so, we need to tell the software: -
What should go on rows and columns versus be nested in the assay. -
Which rows in our table to consider as “control” versus “treated” for
normalization. - Which data type should be converted into SE.</p>
<p>We can do so by setting the <code>untreated_tag</code> identifier
like
<code>set_env_identifier("untreated_tag" = c("MY_CONTROL_TERMINOLOGY_HERE"))</code>.
specifying the <code>nested_keys</code> argument within
<code>create_and_normalize_SE</code> and specifiying
<code>data_type</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gdrplatform.github.io/gDRcore/reference/prepare_input.html">prepare_input</a></span><span class="op">(</span><span class="va">imported_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in .set_nested_confounders(nested_confounders = nested_confounders, : 'Plate' nested confounder(s) is/are not present in the data.</span></span>
<span><span class="co">#&gt;     Switching into 'Barcode' nested confounder(s).</span></span>
<span><span class="va">detected_data_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">inl</span><span class="op">$</span><span class="va">exps</span><span class="op">)</span></span>
<span><span class="va">detected_data_types</span></span>
<span><span class="co">#&gt; [1] "combination"  "single-agent"</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gdrplatform.github.io/gDRcore/reference/runDrugResponseProcessingPipelineFxns.html">create_and_normalize_SE</a></span><span class="op">(</span></span>
<span>  <span class="va">inl</span><span class="op">$</span><span class="va">df_list</span><span class="op">[[</span><span class="st">"single-agent"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  data_type <span class="op">=</span> <span class="st">"single-agent"</span>,</span>
<span>  nested_confounders <span class="op">=</span> <span class="va">inl</span><span class="op">$</span><span class="va">nested_confounders</span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO [2024-11-06 07:59:37] </span></span>
<span><span class="co">#&gt; INFO [2024-11-06 07:59:37]</span></span>
<span><span class="va">se</span></span>
<span><span class="co">#&gt; class: SummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 3 6 </span></span>
<span><span class="co">#&gt; metadata(3): identifiers experiment_metadata Keys</span></span>
<span><span class="co">#&gt; assays(3): RawTreated Controls Normalized</span></span>
<span><span class="co">#&gt; rownames(3): G00002_drug_002_moa_A_168 G00004_drug_004_moa_A_168</span></span>
<span><span class="co">#&gt;   G00011_drug_011_moa_B_168</span></span>
<span><span class="co">#&gt; rowData names(4): Gnumber DrugName drug_moa Duration</span></span>
<span><span class="co">#&gt; colnames(6): CL00011_cellline_BA_breast_cellline_BA_unknown_26</span></span>
<span><span class="co">#&gt;   CL00012_cellline_CA_breast_cellline_CA_unknown_30 ...</span></span>
<span><span class="co">#&gt;   CL00015_cellline_FA_breast_cellline_FA_unknown_42</span></span>
<span><span class="co">#&gt;   CL00018_cellline_IB_breast_cellline_IB_unknown_54</span></span>
<span><span class="co">#&gt; colData names(6): clid CellLineName ... subtype ReferenceDivisionTime</span></span></code></pre></div>
<p>Note that this has created a SummarizedExperiment object with
<code>rowData</code>, <code>colData</code>, <code>metadata</code> and 3
<code>assays</code>.</p>
</div>
<div class="section level3">
<h3 id="averaging-and-fitting-data-3">Averaging and fitting data (3)<a class="anchor" aria-label="anchor" href="#averaging-and-fitting-data-3"></a>
</h3>
<p>Next, we can average and fit the data of interest.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gdrplatform.github.io/gDRcore/reference/runDrugResponseProcessingPipelineFxns.html">average_SE</a></span><span class="op">(</span><span class="va">se</span>, data_type <span class="op">=</span> <span class="st">"single-agent"</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gdrplatform.github.io/gDRcore/reference/runDrugResponseProcessingPipelineFxns.html">fit_SE</a></span><span class="op">(</span><span class="va">se</span>, data_type <span class="op">=</span> <span class="st">"single-agent"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span></span>
<span><span class="co">#&gt; class: SummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 3 6 </span></span>
<span><span class="co">#&gt; metadata(5): identifiers experiment_metadata Keys fit_parameters</span></span>
<span><span class="co">#&gt;   .internal</span></span>
<span><span class="co">#&gt; assays(5): RawTreated Controls Normalized Averaged Metrics</span></span>
<span><span class="co">#&gt; rownames(3): G00002_drug_002_moa_A_168 G00004_drug_004_moa_A_168</span></span>
<span><span class="co">#&gt;   G00011_drug_011_moa_B_168</span></span>
<span><span class="co">#&gt; rowData names(4): Gnumber DrugName drug_moa Duration</span></span>
<span><span class="co">#&gt; colnames(6): CL00011_cellline_BA_breast_cellline_BA_unknown_26</span></span>
<span><span class="co">#&gt;   CL00012_cellline_CA_breast_cellline_CA_unknown_30 ...</span></span>
<span><span class="co">#&gt;   CL00015_cellline_FA_breast_cellline_FA_unknown_42</span></span>
<span><span class="co">#&gt;   CL00018_cellline_IB_breast_cellline_IB_unknown_54</span></span>
<span><span class="co">#&gt; colData names(6): clid CellLineName ... subtype ReferenceDivisionTime</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rundrugresponseprocessingpipeline">runDrugResponseProcessingPipeline<a class="anchor" aria-label="anchor" href="#rundrugresponseprocessingpipeline"></a>
</h3>
<p>Steps (2) and (3) can be combined into a single step through a
convenience function: <code>runDrugResponseProcessingPipeline</code>.
Moreover, the output is <code>MultiAssayExperiment</code> object with
one experiment per each detected data type. Currently four data types
are supported: ‘single-agent’, ‘cotreatment’, ‘codilution’ and ‘matrix’.
The first three data types are processed via the ‘single-agent’ model
while the ‘marix’ data is processed via the ‘combintation’ model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run gDR pipeline</span></span>
<span><span class="va">mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gdrplatform.github.io/gDRcore/reference/runDrugResponseProcessingPipelineFxns.html">runDrugResponseProcessingPipeline</a></span><span class="op">(</span><span class="va">imported_data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mae</span></span>
<span><span class="co">#&gt; A MultiAssayExperiment object of 2 listed</span></span>
<span><span class="co">#&gt;  experiments with user-defined names and respective classes.</span></span>
<span><span class="co">#&gt;  Containing an ExperimentList class object of length 2:</span></span>
<span><span class="co">#&gt;  [1] combination: SummarizedExperiment with 2 rows and 6 columns</span></span>
<span><span class="co">#&gt;  [2] single-agent: SummarizedExperiment with 3 rows and 6 columns</span></span>
<span><span class="co">#&gt; Functionality:</span></span>
<span><span class="co">#&gt;  experiments() - obtain the ExperimentList instance</span></span>
<span><span class="co">#&gt;  colData() - the primary/phenotype DataFrame</span></span>
<span><span class="co">#&gt;  sampleMap() - the sample coordination DataFrame</span></span>
<span><span class="co">#&gt;  `$`, `[`, `[[` - extract colData columns, subset, or experiment</span></span>
<span><span class="co">#&gt;  *Format() - convert into a long or wide DataFrame</span></span>
<span><span class="co">#&gt;  assays() - convert ExperimentList to a SimpleList of matrices</span></span>
<span><span class="co">#&gt;  exportClass() - save data to flat files</span></span></code></pre></div>
<p>Note that our final MultiAssayExperiment object can be made up of
multiple experiments with multiple assays:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "combination"  "single-agent"</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assayNames</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "RawTreated"     "Controls"       "Normalized"     "Averaged"      </span></span>
<span><span class="co">#&gt; [5] "excess"         "all_iso_points" "isobolograms"   "scores"        </span></span>
<span><span class="co">#&gt; [9] "Metrics"</span></span></code></pre></div>
<p>Each assay from each experiment can be easily transformed to
<code>data.table</code> format using <code>convert_se_assay_to_dt</code>
function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="va">mae</span><span class="op">[[</span><span class="st">"single-agent"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://gdrplatform.github.io/gDRstyle/reference/convert_se_assay_to_dt.html">convert_se_assay_to_dt</a></span><span class="op">(</span><span class="va">se</span>, <span class="st">"Metrics"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                          rId                                               cId</span></span>
<span><span class="co">#&gt;                       &lt;char&gt;                                            &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: G00002_drug_002_moa_A_168 CL00011_cellline_BA_breast_cellline_BA_unknown_26</span></span>
<span><span class="co">#&gt; 2: G00002_drug_002_moa_A_168 CL00011_cellline_BA_breast_cellline_BA_unknown_26</span></span>
<span><span class="co">#&gt; 3: G00004_drug_004_moa_A_168 CL00011_cellline_BA_breast_cellline_BA_unknown_26</span></span>
<span><span class="co">#&gt; 4: G00004_drug_004_moa_A_168 CL00011_cellline_BA_breast_cellline_BA_unknown_26</span></span>
<span><span class="co">#&gt; 5: G00011_drug_011_moa_B_168 CL00011_cellline_BA_breast_cellline_BA_unknown_26</span></span>
<span><span class="co">#&gt; 6: G00011_drug_011_moa_B_168 CL00011_cellline_BA_breast_cellline_BA_unknown_26</span></span>
<span><span class="co">#&gt;       x_mean      x_AOC x_AOC_range      xc50      x_max        ec50</span></span>
<span><span class="co">#&gt;        &lt;num&gt;      &lt;num&gt;       &lt;num&gt;     &lt;num&gt;      &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 0.9157913 0.08420865  0.05733832 7.4683485  0.4225500   5.7741811</span></span>
<span><span class="co">#&gt; 2: 0.7420679 0.25793215  0.25820178 4.1712724  0.3065500 100.0000000</span></span>
<span><span class="co">#&gt; 3: 0.6675856 0.33241443  0.32656451 0.4942034  0.0260500   0.4793539</span></span>
<span><span class="co">#&gt; 4: 0.5092443 0.49075566  0.48159819 0.3199532 -0.4177500   0.5757493</span></span>
<span><span class="co">#&gt; 5: 0.3225188 0.67748125          NA      -Inf  0.3225188          NA</span></span>
<span><span class="co">#&gt; 6: 0.2600750 0.73992500          NA      -Inf  0.2600750          NA</span></span>
<span><span class="co">#&gt;          x_inf   x_0         h        r2         p_value        rss  x_sd_avg</span></span>
<span><span class="co">#&gt;          &lt;num&gt; &lt;num&gt;     &lt;num&gt;     &lt;num&gt;           &lt;num&gt;      &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:  0.14499197     1 1.3311221 0.9199573 0.0001450862960 0.03159935 0.8794050</span></span>
<span><span class="co">#&gt; 2: -0.76364407     1 0.2918356 0.7732475 0.0055517820959 0.06111735 0.7276889</span></span>
<span><span class="co">#&gt; 3:  0.04254419     1 2.9149107 0.9751992 0.0000024023028 0.04890734 0.7335509</span></span>
<span><span class="co">#&gt; 4: -0.48824612     1 1.1597048 0.9858751 0.0000003349268 0.03576754 0.5983619</span></span>
<span><span class="co">#&gt; 5:          NA    NA        NA        NA              NA         NA 0.2540203</span></span>
<span><span class="co">#&gt; 6:          NA    NA        NA        NA              NA         NA 0.3936048</span></span>
<span><span class="co">#&gt;                  fit_type maxlog10Concentration N_conc normalization_type</span></span>
<span><span class="co">#&gt;                    &lt;char&gt;                 &lt;num&gt;  &lt;int&gt;             &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: DRC3pHillFitModelFixS0              1.000000      9                 RV</span></span>
<span><span class="co">#&gt; 2: DRC3pHillFitModelFixS0              1.000000      9                 GR</span></span>
<span><span class="co">#&gt; 3: DRC3pHillFitModelFixS0              1.000000      9                 RV</span></span>
<span><span class="co">#&gt; 4: DRC3pHillFitModelFixS0              1.000000      9                 GR</span></span>
<span><span class="co">#&gt; 5:   DRCTooFewPointsToFit             -0.823909      1                 RV</span></span>
<span><span class="co">#&gt; 6:   DRCTooFewPointsToFit             -0.823909      1                 GR</span></span>
<span><span class="co">#&gt;    fit_source Gnumber DrugName drug_moa Duration    clid CellLineName Tissue</span></span>
<span><span class="co">#&gt;        &lt;char&gt;  &lt;char&gt;   &lt;char&gt;   &lt;char&gt;    &lt;num&gt;  &lt;char&gt;       &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:        gDR  G00002 drug_002    moa_A      168 CL00011  cellline_BA breast</span></span>
<span><span class="co">#&gt; 2:        gDR  G00002 drug_002    moa_A      168 CL00011  cellline_BA breast</span></span>
<span><span class="co">#&gt; 3:        gDR  G00004 drug_004    moa_A      168 CL00011  cellline_BA breast</span></span>
<span><span class="co">#&gt; 4:        gDR  G00004 drug_004    moa_A      168 CL00011  cellline_BA breast</span></span>
<span><span class="co">#&gt; 5:        gDR  G00011 drug_011    moa_B      168 CL00011  cellline_BA breast</span></span>
<span><span class="co">#&gt; 6:        gDR  G00011 drug_011    moa_B      168 CL00011  cellline_BA breast</span></span>
<span><span class="co">#&gt;    parental_identifier subtype ReferenceDivisionTime</span></span>
<span><span class="co">#&gt;                 &lt;char&gt;  &lt;char&gt;                 &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:         cellline_BA unknown                    26</span></span>
<span><span class="co">#&gt; 2:         cellline_BA unknown                    26</span></span>
<span><span class="co">#&gt; 3:         cellline_BA unknown                    26</span></span>
<span><span class="co">#&gt; 4:         cellline_BA unknown                    26</span></span>
<span><span class="co">#&gt; 5:         cellline_BA unknown                    26</span></span>
<span><span class="co">#&gt; 6:         cellline_BA unknown                    26</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<p>Once the data is stored in the database, there are multiple ways to
visualize the data depending on the scientific needs. The primary method
to do is through our RShiny visualization tool ‘gDRviz’. Here, users can
search and select experiments present in the database, and use
downstream visualization modules to look at dose response curves,
heatmaps, etc.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="sessioninfo">SessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.3.0 (2023-04-21)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Etc/UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] kableExtra_1.4.0 gDR_1.5.1        gDRutils_1.3.17  gDRimport_1.3.5 </span></span>
<span><span class="co">#&gt; [5] gDRcore_1.5.1    BiocStyle_2.30.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] viridisLite_0.4.2           bitops_1.0-9               </span></span>
<span><span class="co">#&gt;   [3] fastmap_1.2.0               RCurl_1.98-1.16            </span></span>
<span><span class="co">#&gt;   [5] BumpyMatrix_1.10.0          TH.data_1.1-2              </span></span>
<span><span class="co">#&gt;   [7] digest_0.6.37               lifecycle_1.0.4            </span></span>
<span><span class="co">#&gt;   [9] survival_3.5-5              magrittr_2.0.3             </span></span>
<span><span class="co">#&gt;  [11] compiler_4.3.0              rlang_1.1.4                </span></span>
<span><span class="co">#&gt;  [13] sass_0.4.9                  drc_3.0-1                  </span></span>
<span><span class="co">#&gt;  [15] tools_4.3.0                 plotrix_3.8-4              </span></span>
<span><span class="co">#&gt;  [17] utf8_1.2.4                  yaml_2.3.10                </span></span>
<span><span class="co">#&gt;  [19] data.table_1.16.2           knitr_1.48                 </span></span>
<span><span class="co">#&gt;  [21] lambda.r_1.2.4              S4Arrays_1.2.1             </span></span>
<span><span class="co">#&gt;  [23] DelayedArray_0.28.0         xml2_1.3.6                 </span></span>
<span><span class="co">#&gt;  [25] abind_1.4-8                 multcomp_1.4-26            </span></span>
<span><span class="co">#&gt;  [27] BiocParallel_1.36.0         purrr_1.0.2                </span></span>
<span><span class="co">#&gt;  [29] BiocGenerics_0.48.1         desc_1.4.3                 </span></span>
<span><span class="co">#&gt;  [31] grid_4.3.0                  stats4_4.3.0               </span></span>
<span><span class="co">#&gt;  [33] fansi_1.0.6                 colorspace_2.1-1           </span></span>
<span><span class="co">#&gt;  [35] scales_1.3.0                MASS_7.3-58.4              </span></span>
<span><span class="co">#&gt;  [37] gtools_3.9.5                MultiAssayExperiment_1.28.0</span></span>
<span><span class="co">#&gt;  [39] SummarizedExperiment_1.32.0 cli_3.6.3                  </span></span>
<span><span class="co">#&gt;  [41] mvtnorm_1.3-2               rmarkdown_2.29             </span></span>
<span><span class="co">#&gt;  [43] crayon_1.5.3                ragg_1.2.7                 </span></span>
<span><span class="co">#&gt;  [45] rstudioapi_0.15.0           readxl_1.4.3               </span></span>
<span><span class="co">#&gt;  [47] cachem_1.1.0                stringr_1.5.1              </span></span>
<span><span class="co">#&gt;  [49] splines_4.3.0               zlibbioc_1.48.2            </span></span>
<span><span class="co">#&gt;  [51] assertthat_0.2.1            parallel_4.3.0             </span></span>
<span><span class="co">#&gt;  [53] BiocManager_1.30.22         formatR_1.14               </span></span>
<span><span class="co">#&gt;  [55] cellranger_1.1.0            XVector_0.42.0             </span></span>
<span><span class="co">#&gt;  [57] matrixStats_1.4.1           vctrs_0.6.5                </span></span>
<span><span class="co">#&gt;  [59] Matrix_1.6-5                sandwich_3.1-1             </span></span>
<span><span class="co">#&gt;  [61] jsonlite_1.8.9              carData_3.0-5              </span></span>
<span><span class="co">#&gt;  [63] bookdown_0.37               car_3.1-3                  </span></span>
<span><span class="co">#&gt;  [65] IRanges_2.36.0              S4Vectors_0.40.2           </span></span>
<span><span class="co">#&gt;  [67] Formula_1.2-5               systemfonts_1.0.5          </span></span>
<span><span class="co">#&gt;  [69] testthat_3.2.1              jquerylib_0.1.4            </span></span>
<span><span class="co">#&gt;  [71] rematch_2.0.0               glue_1.8.0                 </span></span>
<span><span class="co">#&gt;  [73] pkgdown_2.0.7               codetools_0.2-19           </span></span>
<span><span class="co">#&gt;  [75] stringi_1.8.4               futile.logger_1.4.3        </span></span>
<span><span class="co">#&gt;  [77] GenomeInfoDb_1.38.8         GenomicRanges_1.54.1       </span></span>
<span><span class="co">#&gt;  [79] munsell_0.5.1               tibble_3.2.1               </span></span>
<span><span class="co">#&gt;  [81] pillar_1.9.0                htmltools_0.5.8.1          </span></span>
<span><span class="co">#&gt;  [83] brio_1.1.4                  GenomeInfoDbData_1.2.11    </span></span>
<span><span class="co">#&gt;  [85] R6_2.5.1                    textshaping_0.3.7          </span></span>
<span><span class="co">#&gt;  [87] evaluate_1.0.1              lattice_0.21-8             </span></span>
<span><span class="co">#&gt;  [89] Biobase_2.62.0              futile.options_1.0.1       </span></span>
<span><span class="co">#&gt;  [91] backports_1.5.0             memoise_2.0.1              </span></span>
<span><span class="co">#&gt;  [93] bslib_0.8.0                 svglite_2.1.3              </span></span>
<span><span class="co">#&gt;  [95] SparseArray_1.2.4           checkmate_2.3.2            </span></span>
<span><span class="co">#&gt;  [97] xfun_0.49                   fs_1.6.5                   </span></span>
<span><span class="co">#&gt;  [99] MatrixGenerics_1.14.0       zoo_1.8-12                 </span></span>
<span><span class="co">#&gt; [101] pkgconfig_2.0.3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Allison Vuong, Bartosz Czech, Arkadiusz Gladki, Marc Hafner, Dariusz Scigocki, Janina Smola, Sergiu Mocanu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
